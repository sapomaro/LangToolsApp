<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=0.5">
	<title>üîÅ –ü–æ–∏—Å–∫ –ø–æ–≤—Ç–æ—Ä–æ–≤ —Å–ª–æ–≤ v0.3.3</title>
	<style type="text/css">
html, body {
	position: relative; 
	width: 100%;
	min-height: 100%; 
	height: 100%; 
	margin: 0; 
	padding: 0; 
	background: #f3f3f3;
	font: 18px/18px "Arial Unicode",Arial,Helvetica,sans-serif;
}

@media (min-width:320px) {
	body {
		font-size: 36px; 
		line-height: 36px;
	}
	#container {
		width: 100%;
	}
}
@media (min-width:800px) {
	body {
		font-size: 18px; 
		line-height: 18px;
	}
	#container {
		width: 40em;
	}
}

#container {
	position: relative; 
	/*display: inline-block;
	min-width: 100%;*/
	
	min-height: 100%; 
	height: 100%;
	margin: 0 auto;
}

#load-indicator {
	border:2px solid transparent;
}
h1 {
	margin: 2ex 0;
	line-height: 1;
	color: #333;
}

.form-controls {
	clear: both;
}
.form-controls:after {
	content: "";
	display: table;
	clear: both;
}
.form-controls-left {
	float: left;
}
.form-controls-right {
	float: right;
}

.form-fieldset {
	clear: both;
	width: 100%; 
	margin: 1ex 0;
	border: 2px solid #333;
	background: #fff;
}
.form-area {
	font: 100%/1 monospace; 
	width: 90%;
	height: 30ex; 
	display: block;
	margin: 0; 
	padding: 5%;
	/*box-sizing: border-box;*/
	border: 2px solid transparent;
	resize: none;
	background: transparent;
	white-space: pre-wrap;
	overflow-wrap: break-word;
	overflow: none; outline: none;
}
.form-view { 
	position: absolute; 
	z-index: 1; 
	color: #aaa; 
}
.form-edit { 
	position: relative; 
	z-index: 2; 
	color: #333; 
}
.form-button, .form-field {
	font: 100%/1 monospace; 
	box-sizing: border-box;
	height: 5ex;
	margin: 1ex 0;
	padding: 10px;
	border: 2px solid #333;

	outline: none;
}
.form-button {
	background: #333;
	color: #fff;
}
.form-field {
	width: 3em;
}
.form-summary {
	width: 15em;
	color: #999;
}


.form-button:active {
	transform: scale(0.98);
}
.form-button:disabled {
	background: #999;
	border-color: #999;
	color: #fff;
	transform: scale(1);
	cursor: not-allowed;
}
.form-field:disabled {
	border-color: #999;
	cursor: not-allowed;
}
.form-view-highlight { text-decoration: underline; }
.form-view-highlight0 { color: red; }
.form-view-highlight1 { color: gold; }
.form-view-highlight2 { color: blue; }
.form-view-highlight3 { color: fuchsia; }
.form-view-highlight4 { color: lime; }
.form-view-highlight5 { color: aqua; }
.form-view-highlight6 { color: green; }
.form-view-highlight7 { color: orange; }
.form-view-highlight8 { color: olive; }
.form-view-highlight9 { color: teal; }
	</style>
</head>
<body lang="ru">
	<div id="container">
		<h1>–ü–æ–∏—Å–∫ –ø–æ–≤—Ç–æ—Ä–æ–≤ —Å–ª–æ–≤</h1>
		<form name="repetitions">
			<div class="form-controls">
				<div class="form-controls-left">
					<button name="submit" class="form-button">
						<b id="form-indicator"></b> –ù–∞–π—Ç–∏ –ø–æ–≤—Ç–æ—Ä—ã –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏: 
					</button>&ensp;
					<input name="distance" class="form-field">&ensp;—Å–ª–æ–≤
				</div>
				<div class="form-controls-right">
					<button name="delete" class="form-button">‚å¶ –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ–∫—Å—Ç</button>
				</div>
			</div>
			<div class="form-fieldset">
				<output name="view" class="form-area form-view"></output>
				<textarea name="edit" class="form-area form-edit" spellcheck="false" data-placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ç–µ–∫—Å—Ç..."></textarea>
			</div>
			<div class="form-controls">
				<button name="up" class="form-button"><b>‚≠±</b> –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–≤–µ—Ä—Ö</button>
				<!--
				<div class="form-controls-left">
					
				</div>
				<div class="form-controls-right">
					<input name="summary" class="form-field form-summary" readonly="readyonly">
				</div>-->
			</div>
		</form>
		<br><br><br>
	</div>
<script type="text/javascript">
	window.LangToolsApp = {}; 

window.LangToolsApp.RusWordFormsModule = (function() {
	"use strict";
	
	var parseMorphemes = function(line) { // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —á–∞—Å—Ç–∏ —Å–ª–æ–≤ –≤ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
		return line.replace('—ë', '–µ')
			.split(/[^–ê-–Ø–Å–∞-—è—ë]+/)
			.sort(function(a, b) { return b.length - a.length; });
	};

	var prefixes = parseMorphemes(
		'–≤-, –≤–æ-, –≤–∑–æ-, –≤–Ω–µ-, –≤–Ω—É—Ç—Ä–∏-, –≤–æ–∑–æ-, –≤—ã-, –¥–æ-, –µ–∂–µ-, –∑–∞-, –∑–∞–∫–æ-,'+
		'–∏–∑–æ-, –∏—Å–ø–æ–¥-, –∫-, –∫–æ–µ-, –∫—É-, –º–µ–∂-, –º–µ–∂–¥–æ-, –º–µ–∂–¥—É-, –Ω–∞-, –Ω–∞–¥-, –Ω–∞–¥–æ-, '+
		'–Ω–∞–∏-, –Ω–µ-, –Ω–µ–¥–æ-, –Ω–∏-, –Ω–∏–∑–æ-, –æ-, –æ–±-, –æ–±–æ-, –æ–∫–æ–ª–æ-, –æ—Ç-, –æ—Ç–æ-, –ø–∞-, '+
		'–ø–µ—Ä–µ-, –ø–æ-, –ø–æ–¥-, –ø–æ–¥–æ-, –ø–æ–∑–∞-, –ø–æ—Å–ª–µ-, –ø—Ä–∞-, –ø—Ä–µ–¥-, –ø—Ä–µ–¥–∏-, –ø—Ä–µ–¥–æ-, –ø—Ä–æ-,'+
		'–ø—Ä–æ—Ç–∏–≤–æ-, —Ä–∞–∑–æ-, —Å-, —Å–æ-, —Å–≤–µ—Ä—Ö-, —Å—Ä–µ–¥–∏-, —Å—É-, —Ç—Ä–µ-, —É-, –±–µ–∑-, –±–µ—Å-, –≤–∑-,'+
		'–≤—Å-, –≤–æ–∑-, –≤–æ—Å-, –∏–∑-, –∏—Å-, –Ω–∏–∑-, –Ω–∏—Å-, –æ–±–µ–∑-, –æ–±–µ—Å-, —Ä–∞–∑-, —Ä–∞—Å-, —Ä–æ–∑-, —Ä–æ—Å-,'+
		'—á–µ—Ä–µ–∑-, —á–µ—Ä–µ—Å-, —á—Ä–µ–∑-, —á—Ä–µ—Å-, –ø—Ä–µ-, –ø—Ä–∏-, –∑–ª–æ-, –≤–∑–∞–∏–º–æ-, –ø—Å–µ–≤–¥–æ-, –∞–Ω—Ç–∏-, –≥–µ–æ-,'+
		'–≤–µ–∑–¥–µ-, –º–Ω–æ–≥–æ-, –æ–¥–Ω–æ-, –Ω–µ–æ–¥–Ω–æ-, –¥–≤—É-, –¥–≤—É—Ö'
	);
	var suffixes = parseMorphemes( 
		'-–∞–π—à-, -–µ-, -–µ–µ-, -–µ–π-, -–µ–π—à-, -–∂–µ-, -—à–µ-, -–ª-, -–µ–ª-, -—Ç–∏, -—Ç—å, -–∏, -–∞—â-,'+
		'-—è—â-, -–≤—à-, -—à-, -—É—â-, -—é—â-, -–µ–º-, -–∏–º-, -–æ–º-, -–Ω–Ω-, -–µ–Ω–Ω-, -–æ–Ω–Ω-, -—Ç-, -–∏—Ç—å, -–∞-, -—è-,'+
		'-—É—á–∏-, -—é—á–∏-, -–≤—à–∏-, -—à–∏-, -–µ—Å-, -–µ–Ω-, -–µ—Ä-, -–π-, -–µ–π—à-, -–∞–π—à-, -–∫-, -–∏–∫-, '+
		'-–µ–∫-, -–æ–∫-, -—á–∏–∫, -—ë–∫-, -–µ–Ω—å–∫-, -–æ–Ω—å–∫-, -–µ—á–∫-, -–∏—á–∫-, -–∏—á-, -–æ—á–∫-, -–∞—à–∫-, -–∞—à–Ω-, -–∏—à–∫-, -–∞—à–µ–∫-'+
		'-—É—à–∫-, -—é—à–∫-, -—ã—à–∫-, -–µ—Ü-, -–∏—Ü-, -–µ–Ω–∫-, -–∏–Ω–∫-, -–æ–Ω–∫-, -–∏–Ω-, -–∏—â-, -—É—à–µ–∫, -—ã—à–µ–∫,'+
		'-—ë–Ω—ã—à, -–µ–Ω—å–∫-, -–æ–Ω—å–∫-, -–µ—Ö–æ–Ω—å–∫-, -–æ—Ö–∞–Ω—å–∫-, -—ë—à–µ–Ω—å–∫-, -–æ—à–µ–Ω—å–∫-, -—É—â-, -—é—â-, '+
		'-—é—Å–µ–Ω—å–∫-, -–µ–Ω–Ω-, -–æ–≤–∞—Ç-, -–µ–Ω—å–∫-, -–æ–Ω—å–∫-, -–µ–Ω–µ—á–∫–æ, -–æ–Ω–µ—á–∫–æ, -–µ–≤–∞—Ç, -–æ–≤–∞—Ç, -—Ç–µ–ª—å, '+
		'-—á–∏–∫, -—â–∏–∫, -–Ω–∏–∫, -–∏—Ä, -–Ω–∏—Ü-, -–∫-, -–∏—Ü-, -—é—Ö, -—ë–Ω–æ–∫, -—É—à–∫-, -—ã—à–∫-, -–æ—Å—Ç—å, -–æ—Å—Ç-, -—è–∫, -—É–Ω, -–∞—á, '+
		'-—É—â-, -–∏–≤-, -–∏–≤–Ω-, -—á–∏–≤-, -–ª–∏–≤-, -–∏—Å—Ç-, -—Å–∫-, -–µ—Å–∫-, -–æ–≤-, -–µ–≤-, -–Ω-, -–µ–≤–∏—Ç-, -–∏–Ω-, -–æ–≤–∞-, -–µ–≤–∞-, '+
		'-—ã–≤–∞-, -–∏-, -—è-, -–µ-, -–∞-, -–∞, -–æ, -—É, -–∏–π—Å–∫-, -—Å—Ç–≤-, -–µ—Å—Ç–≤, -–∞—Ä–Ω-, -–∞—Ä–∏–∫, -–∞—Ü-, -—å'+
		'-–æ—Ç-, -–ª–æ–≥'
	); // , -—Ö–æ–¥
	var endings = parseMorphemes( 
		'-–∞, -–∞–º, -–∞–º–∏, -–∞—Å, -–∞—Ö, -–∞—è, -–µ, -–µ—ë, -–µ–π, -–µ–º, -–µ–º–∏, -–µ–º—è,'+
		'-–µ—Ö, -–µ—é, -—ë—Ç, -—ë—Ç–µ, -—ë—Ö, -—ë—à—å, -–∏, -–∏–µ, -–∏–π, -–∏—è, -–∏–º, -–∏–º–∏, -–∏—Ç,'+
		'-–∏—Ç–µ, -–∏—Ö, -–∏—à—å, -–∏—é, -–º, -–º–∏, -–º—è, -–æ, -–æ–≤, -–æ–≥–æ, -–æ–µ, -–æ—ë,'+
		'-–æ–π, -–æ–º, -–æ–º—É, -–æ—é, -—É, -—É–º, -—É–º—è, -—É—Ç, -—É—Ö, -—É—é, -—à—å, -—ã–π, -—ã–µ'+
		'-–∞, -—è, -—ã, -–∏, -–æ–≤, -–µ–π, -–µ, -–∞–º, -—è–º, -—É, -—é,'+ // —Å—É—â. –∏.–º.-–≤.–ø.
		'-–æ–π, -—ë–π, -–∞–º–∏, -—è–º–∏, -–æ–º, -–µ–º, -—ë–º, -–∞—Ö, -—è—Ö,'+ // —Å—É—â. —Ç.–ø.-–ø.–ø.
		'-—É, -—é, -–µ—à—å, -–µ—Ç, -–µ–º, -–µ—Ç–µ, -—É—Ç, -—é—Ç, -–∏—à—å, -–∏—Ç, -–∏–º, -–∏—Ç–µ, -–∞—Ç, -—è—Ç,'+ // –≥–ª. 1/2 —Å–ø—Ä—è–∂.
		'-—ã–π, -–∏–π, -–∞—è, -—è—è, -–æ–µ, -–µ–µ, -—ã–µ, -–∏–µ, -–æ–≥–æ, -–µ–≥–æ, -–æ–π, -–µ–π, -—ã—Ö, -–∏—Ö,'+ // –ø—Ä–∏–ª. –∏–º./—Ä–æ–¥.–ø.
		'-–æ–º—É, -–µ–º—É, -–æ–π, -–µ–π, -—ã–º, -–∏–º, -—É—é, -—é—é, -—ã–º–∏, -–∏–º–∏, -–æ–º, -–µ–º' // –ø—Ä–∏–ª. –¥–∞—Ç./–≤–∏–Ω./—Ç–≤–æ—Ä.–ø.
	); 
	var unbreakableRoots = parseMorphemes( // –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–æ—Ä–Ω–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–≤–µ—Ä–Ω–æ —Ä–∞–∑–±–∏—Ç—ã
		'–≤–∞—à, –≤–µ–∫, –≤–µ—Ä, –≤–µ—Å, –≤–∏–¥, –≤–æ–¥, –≤—Ä–µ–¥, –≤–µ—á–µ—Ä, –≤–ª–∞—Å—Ç, –≤–æ–ø—Ä–æ—Å, –≤–æ–π–Ω, –≤—Ç–æ—Ä, –≤–æ–∑—Ä–∞–∂, '+
		'–≥–∞–∑–æ–Ω, –¥–µ–ª, –¥–æ—Ö–æ–¥, –¥–æ—Å—Ç—É–ø, –¥–æ–ª–∂, –∑–∞–∫–æ–Ω, –∑–∞—Å–ª–æ–Ω, –∑–∞–ø–∞–¥, –∏—Å—Ç–æ—Ä, '+
		'–∫—Ä–∞—Ç, –∫—Ä—ã–ª, –º—ã—à, –Ω–∞—á–∞–ª, –Ω–∞—á–∏–Ω, –Ω–µ–¥–µ–ª, –Ω–∞—à, '+
		'–æ–±–ª–∞—Å—Ç, –æ–±—Ä–∞–∑, –æ—Å—Ç—Ä–æ–≤, –æ—Ç—Ä–∞–∂, –æ–±—Ä–µ—á, '+
		'–ø—É—Ç, –ø–æ—Ä–∞, –ø–æ–ª—É—á, –ø–æ–ª–Ω, –ø—Ä–∞–≤, –ø—Ä–∞–≤–ª, –ø—Ä–∞–≤–∏–ª, –ø—Ä–æ–µ–∫—Ç, –ø—Ä–æ—Å—Ç, –ø–æ—Å—Ç–∞–≤, '+
		'–ø—Ä–æ—Ü–µ—Å—Å, –ø—Ä–µ—Å—Ç—É–ø, –ø–ª–∞–Ω–µ—Ç, –ø–æ–ª–∏—Ç, –ø–æ—Å–ª–µ–¥, –ø—Ä–æ–¥–æ–ª–∂, –ø—Ä–µ–¥–µ–ª, –ø–æ–≤–µ—Å—Ç–∫, '+
		'—Ä–∞–¥, —Ä–∞–∑–≤–∏—Ç, —Ä–∞–∑—Ä–∞–±–æ—Ç, '+
		'—Å–∏–¥, —Å–≤–∏–¥–µ, —Å–ª–µ–¥, —Å–ª–æ–≤, —Å–ª—É—á, —Å—Ç—Ä–∞–Ω, —Å–∏–ª, —Å–∏—Å—Ç–µ–º, —Å—Ä–µ–¥—Å—Ç–≤, —Å—Ç–æ–ª, —Å—Ç–æ–ª–∏—Ü, —Å–≤–µ–¥–µ–Ω, '+ 
		'—Å—Ç–æ—Ä–æ–Ω, —Å–≤—è–∑, —Å–∏—Ç—É–∞—Ü, —Å–æ—é–∑, —Å–æ–≤–µ—Ç, —Å—Ç–∞—Ç, —Å—É–≤–µ—Ä–µ–Ω, —Å–æ–¥–µ—Ä–∂, —Å–æ–≤–µ—Ä—à, —Å–≤–µ—Ç, —Å–ª–æ–Ω,'+
		'—Ç–∏—à, —Ç–µ—Å—Ç, '+
		'—É–¥–µ–ª, —É—Å—Ç–∞–≤, —É—Å–ª–æ–≤, —É—á–∞—Å—Ç, —É–≤–∞–∂, —É—Å—Ç—É–ø, —É–ª–∏—Ü, —É–∫–∞–∑, —Ñ–æ—Ä–º—É–ª'
	); 
	
	/*	—Å–ø–æ—Ä–Ω—ã–µ —Å–ª—É—á–∞–∏: 
			–ø–æ—Å–ª–µ–¥–Ω–∏–π - –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è
			—Å–Ω–µ–≥ - —Å–Ω–µ–∂–Ω—ã–π
			—Ç–µ–º–∞ - —Ç–µ–º–Ω—ã–π
			–ù—å—é-–î–µ–ª–∏ - –¥–µ–ª–∏—Ç—å
	*/
	
	var immutableRoots = '–Ω–∏–∫—Ç–æ, –ø–æ–∫–∞, —Ä–∞–¥–∏, —Ç–∞–º, —Ç–∞–∫, –∫–∞–∫, –∫—Ç–æ, —á—Ç–æ, —Ä–∞–∑, –≤–Ω–µ, –ø—Ä–∏';
	
	
	var wordFormsHandler = function(word) {
		var wordRoot = word; // –∫–æ—Ä–µ–Ω—å –±–µ–∑ –∞—Ñ—Ñ–∏–∫—Å–æ–≤
		var wordRootPrefixed = word; // –∫–æ—Ä–µ–Ω—å —Å –ø—Ä–∏—Å—Ç–∞–≤–∫–æ–π (–¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è)
		var wordRootSuffixed = word; // –∫–æ—Ä–µ–Ω—å —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º (–¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è)
		var wordRootMatched = false; // –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∫–æ—Ä–Ω—è
		
		if (immutableRoots.indexOf(wordRoot) !== -1 || unbreakableRoots.indexOf(wordRoot) !== -1) { 
			return [word, wordRoot, wordRootPrefixed, wordRootSuffixed]; 
		}
		
		for (var r = 0; r < unbreakableRoots.length; ++r) { // –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∫–æ—Ä–Ω—è
			if (word.length < unbreakableRoots[r].length) { continue; }
			if (word.indexOf(unbreakableRoots[r]) !== -1){
				wordRootMatched = unbreakableRoots[r];
				break;
			}
		}
		
		var parseSequence = [[endings, 2], [suffixes, 2], [suffixes, 3], [prefixes, -3]];
		// –ø–æ—Ä—è–¥–æ–∫ –æ—Ç—Å–µ—á–µ–Ω–∏—è –∞—Ñ—Ñ–∏–∫—Å–æ–≤: —Ç–∏–ø + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—É–∫–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è —É –∫–æ—Ä–Ω—è
		// (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∏—Å—Ç–∞–≤–æ–∫)

		for (var p = 0; p < parseSequence.length; ++p) { // –æ—Ç—Å–µ—á–µ–Ω–∏–µ –∞—Ñ—Ñ–∏–∫—Å–æ–≤ –æ—Ç —Å–ª–æ–≤–∞

			var affixes = parseSequence[p][0]; 
			var minRootSize = parseSequence[p][1];
			var possibleAffixLength = wordRoot.length - Math.abs(minRootSize);
			var wordChunk = '';
			
			for (var i = 0; i < affixes.length; ++i) {
				if (affixes[i].length > possibleAffixLength) { continue; }
				if (minRootSize > 0 && affixes[i] === wordRoot.slice(affixes[i].length * -1)) {
					// –æ—Ç—Å–µ—á–µ–Ω–∏–µ —Å—É—Ñ—Ñ–∏–∫—Å–æ–≤ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏–π
					wordChunk = wordRoot.slice(0, affixes[i].length * -1); // –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä–µ–Ω—å –±–µ–∑ –∞—Ñ—Ñ–∏–∫—Å–∞
					if (wordRootMatched && wordChunk.indexOf(wordRootMatched) === -1) { 
						continue; // –µ—Å–ª–∏ —á–∞—Å—Ç—å –∫–æ—Ä–Ω—è –ø—Ä–æ–ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –æ—Ç—Å–µ—á–µ–Ω–∏–∏ –∞—Ñ—Ñ–∏–∫—Å–∞, —Ç–æ –∏—â–µ—Ç—Å—è –¥—Ä—É–≥–æ–π
					}
					wordRoot = wordChunk;
					wordRootPrefixed = wordRoot;
					if (p == 1) { wordRootSuffixed = wordRoot; }
					break;
				}
				else if (minRootSize < 0 && affixes[i] === wordRoot.slice(0, affixes[i].length)) {
					// –æ—Ç—Å–µ—á–µ–Ω–∏–µ –ø—Ä–∏—Å—Ç–∞–≤–æ–∫
					wordRoot = wordRoot.slice(affixes[i].length);
					wordRootSuffixed = wordRootSuffixed.slice(affixes[i].length);
					break;
				}
			}
			if (unbreakableRoots.indexOf(wordRoot) !== -1) { 
				break; 
			}
		}
		return [word, wordRoot, wordRootPrefixed, wordRootSuffixed];
	};
	
	
	
	
	return { wordFormsHandler: wordFormsHandler };
})();

window.LangToolsApp.RepeatedWordsModule = (function() {
	"use strict";
	
	var exceptions = '–∏–∑, –∑–∞, –Ω–∞, –Ω–µ, –Ω–∏, –ø–æ, –±—ã, –¥–æ, –¥–ª—è, –ø–æ–¥'; // –ø–æ–≤—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å—Å—è
	
	var wordMatrix = {};
	
	wordMatrix.parseInputText = function(text) { // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ç–µ–∫—Å—Ç –≤ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
		return text.replace('—ë', '–µ')
			.split(/[^–ê-–Ø–Å–∞-—è—ëA-Za-z]+/)
			.filter(String);
	};
		
	wordMatrix.build = function(text, wordFormsHandler) {
		// —Å–æ–∑–¥–∞—ë—Ç –º–∞—Ç—Ä–∏—Ü—É –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–ª–æ–≤–æ—Ñ–æ—Ä–º (—Å–ª–æ–≤–æ —Ü–µ–ª–∏–∫–æ–º, –∫–æ—Ä–µ–Ω—å —Å–ª–æ–≤–∞, —Å–ª–æ–≤–æ –±–µ–∑ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏, —Å–ª–æ–≤–æ –±–µ–∑ —Å—É—Ñ—Ñ–∏–∫—Å–∞)
		var wordsArray = this.parseInputText(text);
		var word = '';
		var wordForms = [];
		this.matrix = {};
		
		for (var pos = 0; pos < wordsArray.length; ++pos) {
			pos = parseInt(pos);
			word = wordsArray[pos].toLowerCase();
			
			if (!word) { continue; }
			if (word.length < 2) { continue; }
			if (exceptions.indexOf(word) !== -1) { continue; }
			
			wordForms = wordFormsHandler(word); // word, wordRoot, wordRootSuffixed, wordRootPrefixed
			
			for (var f = 0; f < wordForms.length; ++f) { 
				if (f > 0 && word === wordForms[f]) { continue; }
				
				if ('undefined' === typeof this.matrix[wordForms[f]]) {
					this.matrix[wordForms[f]] = [pos];

				} else if (this.matrix[wordForms[f]].indexOf(pos) === -1) {
					this.matrix[wordForms[f]].push(pos);
				}

			}

		}
		
		this.compareEach();
	};
	
	wordMatrix.compareEach = function() {
		// –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–π –º–∞—Ç—Ä–∏—Ü–µ —Å–ª–æ–≤–æ—Ñ–æ—Ä–º (–¥–ª—è —Å–ª–æ–≤ –¥–ª–∏–Ω–æ–π –Ω–µ –º–µ–Ω–µ–µ 6 –±—É–∫–≤)
		// –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
		for (var word in this.matrix) {
			if (word.length < 6) { continue; }
			if (this.matrix.hasOwnProperty(word) === false) { continue; }
			for (var word2 in this.matrix) {
				if (word2.length < 6) { continue; }
				if (this.matrix.hasOwnProperty(word2) === false) { continue; }
				if (this.matrix[word] === this.matrix[word2]) { continue; }
				
				this.compareLastLetter(word, word2);
				
			}
		}
	};
	wordMatrix.compareLastLetter = function(word, word2) {
		if (word.length === word2.length 
			&& word.slice(0, word.length - 1) === word2.slice(0, word2.length - 1)) {
			// –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å–ª–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –±—É–∫–≤–∞ –≤ –∫–æ–Ω—Ü–µ
			var wordsMapChunk = this.matrix[word].concat(this.matrix[word2]);
			for (var pos = 0; pos < wordsMapChunk.length; ++pos) {
				wordsMapChunk[pos] = parseInt(wordsMapChunk[pos]);
				if (this.matrix[word].indexOf(wordsMapChunk[pos]) === -1) {
					this.matrix[word].push(wordsMapChunk[pos]);
				}
				if (this.matrix[word2].indexOf(wordsMapChunk[pos]) === -1) {
					this.matrix[word2].push(wordsMapChunk[pos]);
				}
			}
		}
	};
	
	
	wordMatrix.getRepetitions = function(searchDistance) {
		// –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏
		if (!searchDistance) { searchDistance = 50; }
		var repetitions = [];
		var pairs = [];
		
		for (var word in this.matrix) {
			if (this.matrix.hasOwnProperty(word) === false) { continue; }
			if (this.matrix[word].length < 2) { continue; } // –ø—Ä–æ–ª–∏—Å—Ç—ã–≤–∞–µ–º —Å–ª–æ–≤–æ—Ñ–æ—Ä–º—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
			var wordPos = this.matrix[word].sort(function(a, b) { return a - b; });
			for (var i = 1; i < wordPos.length; ++i) {
				var wordsDistance = wordPos[i] - wordPos[i - 1];
				if (wordsDistance > 0 && wordsDistance < searchDistance) {
					if (pairs.indexOf(wordPos[i - 1]) === -1) {
						pairs.push(wordPos[i - 1]);
					}
					pairs.push(wordPos[i]);
				}
				else if (pairs.length > 1) {
					repetitions.push(pairs); 
					pairs = [];
				}
			}
			if (pairs.length > 1) {
				repetitions.push(pairs); 
				pairs = [];
			}
		}
		
		return wordMatrix.reduceRepetitions(repetitions, searchDistance);
		
	};
	
	wordMatrix.reduceRepetitions = function(repetitions, searchDistance) {
		// —Å–æ–µ–¥–∏–Ω—è–µ—Ç –ø–æ–≤—Ç–æ—Ä—ã –≤ —Ü–µ–ø–æ—á–∫–∏, —á—Ç–æ–±—ã –æ–Ω–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –æ–¥–Ω–∏–º —Ü–≤–µ—Ç–æ–º
		repetitions = repetitions.sort(function(a, b) { return a[0] - b[0]; });
		for (var r = 0; r < repetitions.length; ++r) {
			if (repetitions[r].length === 0) { continue; }
			for (var rr = r + 1; rr < repetitions.length; ++rr) {
				if ((repetitions[rr][0] - repetitions[r][repetitions[r].length - 1]) > searchDistance) {
					break; // –Ω–µ –ª–∏—Å—Ç–∞–µ—Ç –¥–∞–ª—å—à–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏
				}
				var intersections = repetitions[r].filter(function(item) {
					return (repetitions[rr].indexOf(item) !== -1); // —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Ü–µ–ø–æ—á–µ–∫
				}); 
				if (intersections.length > 0) {
					repetitions[r] = repetitions[r].concat(repetitions[rr].filter(function(item) {
						return (repetitions[r].indexOf(item) < 0);
					})).sort(function(a, b) { return a - b; });
					repetitions[rr] = [];
				}
			}
		}
		return repetitions;
	};
	
	return { wordMatrix: wordMatrix };
	
})();

window.addEventListener('load', function(event) {
	"use strict";
	
	var wordMatrix = LangToolsApp.RepeatedWordsModule.wordMatrix;
	
	var wordFormsHandler = LangToolsApp.RusWordFormsModule.wordFormsHandler;
	
	var ui = document.forms.repetitions;
	ui.indicator = document.querySelector('#form-indicator');

	
	ui.viewUpdate = function() {
		if (ui.edit.value === '') {
			if (ui.edit.dataset && ui.edit.dataset.placeholder) {
				ui.view.innerHTML = ui.edit.dataset.placeholder;
			}
		}
		else {
			ui.view.innerHTML = ui.edit.value;
		}
		ui.edit.autoResize();
		ui.style.height = ui.edit.scrollHeight;
		
		//ui.summary.value = '–ó–∞–≥—Ä—É–∂–µ–Ω–æ';
	};
	ui.toggleButtons = function(state) {
		if (state === 0) {
			ui.indicator.innerHTML = '‚åõ';
			ui.submit.disabled = true;
			ui.distance.disabled = true;
		}
		else {
			ui.indicator.innerHTML = '‚≠æ';
			ui.submit.disabled = false;
			ui.distance.disabled = false;
		}
	};
	
	ui.edit.autoResize = function() {
		this.style.overflowY = 'hidden';
		this.style.marginTop = this.scrollHeight + 'px'; 
		this.style.minHeight = 0;
		this.style.minHeight = this.scrollHeight + 'px'; 
		this.style.marginTop = 0;
	};
	ui.edit.alignLines = function() {
		this.value = this.value.replace(/\n+/g, "\n\n");
	};

	
	ui.edit.addEventListener('input', ui.viewUpdate);
	ui.edit.addEventListener('keyup', ui.viewUpdate);
	ui.viewUpdate();
	ui.toggleButtons(1);
	
	
	ui.distance.value = 70; // —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤
	
	ui.submit.addEventListener('click', function(event) {
		event.preventDefault();
		ui.toggleButtons(0);
		ui.edit.alignLines();
		setTimeout(function() {
			var text = ui.edit.value;
			if (text !== '') { 
				var distance = parseInt(ui.distance.value);
				wordMatrix.build(text, wordFormsHandler);
				var repetitions = wordMatrix.getRepetitions(distance);
				ui.view.innerHTML = text.replace(/([–ê-–Ø–Å–∞-—è—ëA-Za-z]+)/g, "<span>$1</span>");
				var nodeList = ui.view.querySelectorAll('span');
				var highlightStyle = 0;
				for(var r = 0; r < repetitions.length; ++r) {
					if (repetitions[r].length === 0) { continue; }
					++highlightStyle;
					for(var p = 0; p < repetitions[r].length; ++p) {
						if (nodeList.item(repetitions[r][p])) {
							nodeList.item(repetitions[r][p]).className = "form-view-highlight form-view-highlight" + (highlightStyle % 10);
						}
					}
				}
			}
			ui.toggleButtons(1);
		}, 1);
		
	});
	
	ui.delete.addEventListener('click', function(event) {
		event.preventDefault();
		ui.edit.value = '';
		ui.edit.focus();
		ui.viewUpdate();
	});
	
	ui.up.addEventListener('click', function(event) {
		event.preventDefault();
		window.scrollTo(0, 0);
	});
	
	ui.edit.addEventListener('paste', function() {
		setTimeout(function() {
			ui.edit.alignLines();
			ui.viewUpdate();
		}, 1);
	});
	
	var resizeTimer = null;
	window.addEventListener('resize', function(event) {
		if (resizeTimer) { return null; }
		resizeTimer = setTimeout(function() {
			ui.viewUpdate();
			resizeTimer = null;
		}, 100);
	});
	
});

</script>
</body>
</html>